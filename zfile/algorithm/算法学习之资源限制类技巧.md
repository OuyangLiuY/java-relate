## 技巧汇总：

1）布隆过滤器用于集合的建立与查询，并可以节省大量空间
2）一致性哈希解决数据服务器的负载管理问题
3）利用并查集结构做岛问题的并行计算
4）哈希函数可以把数据按照种类均匀分流
5）位图解决某一范围上数字的出现情况，并可以节省大量空间
6）利用分段统计思想、并进一步节省大量空间
7）利用堆、外排序来做多个处理单元的结果合并

## 题目一：

32位无符号整数的范围是0~4,294,967,295，现在有一个正好包含40亿个无符号整数的文件，可以使用最多1GB的内存，怎么找到出现次数最多的数？

**解法思想：**

**备注：** 此时使用哈希函数按照种类分流

40 亿 * 4(int)  = 160亿 大约等于 16G

1G = 1024M * 1024KB*1024Bit 大约等于 1000  * 1000 * 1000 = 1亿

**想法1：**

直接使用哈希表，key 4字节，value 4字节，  40亿 * 8 = 320亿    大约等于 32G，明显不符合

**想法2：**

1. 设置大小为1G的哈希表内存数据，（1000  * 1000 * 1000 = 1亿）设最多装1千万条数，
2. 假设，40亿除以1千万，大概有400，将40亿的数据求哈希值，然后模（%）一下400，
3. 那么将这个记录放到对应的模完之后值得文件上去，
4. 此时根据哈希函数得性质，这40亿个数据将大概均分到 0 ~ 400 号文件中，（假设有40亿种数，那么每个文件种最多有1千万种数据，保证1G 哈希表内存够用）
5. 最多1千万种数，进入到对应文件之后，根据每个字符就可以统计出当前某一种数出现得次数
6. 最后依次遍历这400个文件，获取每个文件中出现最多得次数，最后求400个种最多出现的次数

## 题目二：

32位无符号整数的范围是0~4,294,967,295，现在有一个正好包含40亿个无符号整数的文件，**所以在整个范围中必然存在没出现过的数。**
可以使用最多1GB的内存，怎么找到所有未出现过的数？
【进阶】
内存限制为 3KB，但是只用找到一个没出现过的数即可

**解题思想：**

备注：使用位图解决出现的次数，限制更小的话，那么就等份到某个范围，然后依次求某个范围是否具有

**想法：**

1. 每一个字节代表一个数是否出现过，那么8位才是一个字节，
2. 那么使用2^32次方除以8  那么 1G的内存够用
3. 使用基础类型拼想要的bit类型，比如准备arr[10] 那么一共准备了320bit，此时位置arr[i/32] 则可以求出i%32的状态
4. 求出当前位置的状态：`(arr[i/32] &(1<<(i%32))) == 0 ? 0 : 1`
5. 将这个0 ~ 2^32次方长度位图集合中，将出现的次数的bit为设置为1，
6. 此时遍历一遍arr数组，则位图上不是1的数就是没出现过的数

**进阶解法：**

1. 3KB那么 3000bit/4 = 750长度，那么整形数组最多可以750个
2. 设数组长度为512，可以用2^32将其均分为512份，每一份数据都不超过3KB的
3. 那么求第一个arr[512]数组种，统计每 2^32 / 512(2^9) /512 = 2^14 出现的数，0位置统计 0 ~ 2^14，1位置统计下一个2^14
4. 因为只有40亿整数，所以，必然某个范围类的数是不够2^23个数的，则可以得出这个范围
5. 得到这个范围之后，再将这个范围的数据等分出512份，根据这种方法，最终得到未出现的数

## 题目三：

有一个包含100亿个URL的大文件，假设每个URL占用64B，请找出其中所有重复的URL
【补充】
某搜索公司一天的用户搜索词汇是海量的(百亿数据量)，请设计一种求出每天热门Top100词汇的可行办法

**想法：**

1. 如果题目种允许有失误率，那么可以使用布隆过滤器
2. 如果不允许有失误率，那么可以使用哈希，如果哈希之后不符合条件，那么可以继续哈希，最终，求某个哈希统计之后小文件中是否有重复的

## 题目四：

32位无符号整数的范围是0~4294967295，
现在有40亿个无符号整数，可以使用最多1GB的内存，找出所有出现了两次的数。

**想法：**

使用位，每两位表示某一个数出现得次数，00，没出现，01，一次，10，两次，11，三次，超过三次之后就不更改，最后遍历，求是位上是10得，则可以得到该数据

2^32 / 8 = 536 870 912 大约等于 536M

## 题目五：

32位无符号整数的范围是0~4294967295，现在有40亿个无符号整数
可以使用最多3K的内存，怎么找到这40亿个整数的中位数？

**想法：**

这道题，类似题目二中，进阶题，当前题中40亿个整数的中位数那么就是求40亿的第20亿个数，比如前面求了m个数组中最大数只有19亿，那么第20亿的数，一定在m+1的数组位置上

## 题目六：

32位无符号整数的范围是0~4294967295，有一个10G大小的文件，每一行都装着这种类型的数字，整个文件是无序的，给你5G的内存空间，请你输出一个10G大小的文件，就是原文件所有数字排序的结果

想法：

1. 申请一个内存够用的容器，这个容器就是大根堆，根据大根堆的特性，遍历文件，找到peek下大根堆上堆顶的值，如果容器够用，且当前的值大于堆顶的，那么将其加入到容器，如果是已经加入的，那么只记录当前值对应的次数
2. 当容器满了之后，依次以从小到大输出即可

## 题目七：

求一个大文件中，top 100的问题，

**备注**：这里用到的是堆上堆

**想法：**

将文件进行哈希，分成500份，每份中建立大根堆，那么就有500个最大值，然后再将这个500个最大值，再建立一个大根堆，那么直接遍历出前100个的大根堆即可，

